<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Audio Visualizer based on Three.js</title>
  <link href="https://fonts.googleapis.com/css?family=Saira" rel="stylesheet"><link rel="stylesheet" href="./style.css">

</head>
<body>
<div id="content">
    
    <div className="container">
        <div className="info">
            <h1>Audio Visualizer - Hack-a-thon</h1>
            <!-- <h3>Current Song: Porter Robinson - Sad Machine</h3> -->
            <p className="infoBox">
                
                The blob responds to music
            </p>
        </div>


        <div id="musicBox">
            <label for="thefile" class="file"> Choose an audio file
                <input type="file" id="thefile" accept="audio/*" />
              </label>
          
              <audio id="audio" src="" onPlay="init" controls></audio>
              <div id="out"></div>

        <div className="app-container">
            <canvas id="threejs-canvas"></canvas>
        </div>
    </div>



  </div>
<!-- partial -->


<script src='https://cdnjs.cloudflare.com/ajax/libs/three.js/84/three.min.js'></script>
<!-- <script src='https://cdn.rawgit.com/mrdoob/three.js/master/examples/js/controls/OrbitControls.js'></script> -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.3/dat.gui.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.3.0/simplex-noise.min.js'></script>

<script id="vertexShader" type="x-shader/x-fragment">
    varying float x;
    varying float y;
    varying float z;
    varying vec3 vUv;

    uniform float u_time;
    uniform float u_amplitude;
    uniform float[64] u_data_arr;

    void main() {
      vUv = position;

      x = abs(position.x);
        y = abs(position.y);

      float floor_x = round(x);
        float floor_y = round(y);

      float x_multiplier = (32.0 - x) / 8.0;
      float y_multiplier = (32.0 - y) / 8.0;

      // z = position.z;
      // z = abs(position.x) + abs(position.y);
      // z = sin(abs(position.x) + abs(position.y));
      // z = sin(abs(position.x) + abs(position.y) + u_time * .005);
      z = sin(u_data_arr[int(floor_x)] / 50.0 + u_data_arr[int(floor_y)] / 50.0) * u_amplitude;
      // z = (u_data_arr[int(floor_x)] / 50.0 + u_data_arr[int(floor_y)] / 50.0) * 2.0;

      gl_Position = projectionMatrix * modelViewMatrix * vec4(position.x, position.y, z, 1.0);
    }
</script>

<script id="fragmentShader" type="x-shader/x-fragment">
    varying float x;
      varying float y;
      varying float z;
      varying vec3 vUv;
  
      uniform float u_time;
      // uniform vec3 u_black;
      // uniform vec3 u_white;
  
      void main() {
        // old
        // gl_FragColor = vec4(mix(u_black, u_white, vUv.x), 1.0);
  
        // gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
        // if (vUv.x < 0.0) {
        //   gl_FragColor = vec4(0.0, 1.0, 0.0, 1.0);
        // } else {
        //   gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0);
        // }
        // gl_FragColor = vec4(abs(sin(u_time * .001)), 0.0, 0.0, 1.0);
        gl_FragColor = vec4((32.0 - abs(x)) / 32.0, (32.0 - abs(y)) / 32.0, (abs(x + y) / 2.0) / 32.0, 1.0);
      }
</script>


<script src="./app.js"></script>






</body>
</html>